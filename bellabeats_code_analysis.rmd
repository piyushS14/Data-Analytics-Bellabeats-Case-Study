---
title: "capstone_solution_file"
author: "Piyush Ranjan Satapathy"
output: html_document
---

## Bellabeat data analysis case study


### INTRODUCTION

Bellabeat is a successful and high-tech manufacturer of health-focused products for women. They believe that they can take their growth to a higher level and have the potential to become a leader in the global smart device market. Bellabeat believes that analyzing smart device fitness data could help unlock new growth opportunities for the company. We as the analyst team have been asked to focus on one of Bellabeat’s products and analyze smart device data to gain insights on how effectively customers are using their smart devices. The insights we discover will guide in picking a better marketing strategy to generate better results and attract more customers for the company. 


<b>Their Products include: </b>

 * <b>Bellabeat app :</b> The Bellabeat app provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits.
 
 * <b>Leaf :</b> Bellabeat’s classic wellness tracker can be worn as a bracelet, necklace, or clip. The Leaf tracker connects to the Bellabeat app to track activity, sleep, and stress.
 
 * <b>Time :</b> This wellness watch track user activity, sleep, and stress. The Time watch connects to the Bellabeat app to provide you with insights into your daily wellness.
 
 * <b>Spring :</b> This is a water bottle that tracks daily water to ensure that you are appropriately hydrated throughout the day. The Spring bottle connects to the Bellabeat app to track your hydration levels.
 
 * <b>Bellabeat membership :</b> Membership gives users 24/7 access to fully personalized guidance on nutrition, activity, sleep, health and beauty, and mindfulness based on their lifestyle and goals.
 
 
 




 
### STEPS TO ANALYSIS
 
 
 
 
 
<b> 1.  ASK </b>

 
#### Key Stakeholders: 
 
* <b>Urška Sršen: </b> Bellabeat's cofounder and Chief Creative Officer.
* <b>Sando Mur: </b> Mathematician and Bellabeat's co-founder.


#### Business Task:

To analyse smart device usage data to gain insight into how consumers use non-Bellabeat smart devices. Based on insights, select one Bellabeat product which makes the user more inclusive to use and stay healthy. Make high-level recommendations for how these trends or insights help Bellabeat marketing team craft new strategies.


#### Business Objective:

* What are the trends identified?
* How could these trends apply to Bellabeat customers?
* How could these trends help influence Bellabeat marketing startegy?

#### Deliverables:

* A clear summary of the business task.
* Description of all data sources used.
* Documentation of any cleaning or manipulation done with the raw datasets.
* A summary of analysis from data.
* Supporting visualizations and key findings.

Installing packages required.

```{r}
install.packages("tidyverse")
install.packages("dplyr")
install.packages("tidyr")
install.packages("readr")
install.packages("lubridate")
install.packages("ggplot2")

```


```{r}
library(tidyverse)
library(ggplot2)
library(readr)
library(dplyr)
library(lubridate)

```








<b>2. PREPARE </b>

In this stage, we identify the data being used and find its shortcomings.



#### Information on data source:

* For this case study, we make use of data that is available online. FitBit Fitness Tracker Data (CC0: Public Domain, dataset made available through Mobius) and is stored in 18 csv files.

* Generated by respondents from a survey taken between 12th March 2016 to 12th May 2016. Includes minute-level output for physical activity, daily activities, sleep schedules, steps walked, and heart rate.

* 30 fitbit users consented to the submission of personal tracker data.




#### Limitations Of Data:

* Data that is used here was collected 5 years back in the year 2016. Hence, users’ daily activity, fitness and sleeping habits, diet and food consumption may have changed since then. 

* Data may not be timely or relevant.

* Sample size of 30 FitBit users is not representative of the entire fitness population.

* As data is collected in a survey, we are unable to ascertain its integrity or accuracy.




#### Is Data ROCCC?

A good data source is ROCCC i.e., Reliable, Original, Comprehensive, Current and Cited.

<b>Reliable</b> - The data set provided consists of only 30 respondents and hence it is the least reliabe because the data collected doesn't actually represent the entire fitness popuplation. 

<b>Original</b> - The data is collected via a survey i.e., a third part hence difficult to consider its originality.

<b>Comprehensive</b> - Data parameters allign with most of the Bellabeats fitness parameter. Hence medium level comprehensive.

<b>Current</b> - Data collected is 5 years old hence may not be relevant to current scenario.

<b>Cited</b> - No viable resource


Therefore, the dataset provided doesn't really qualify for generating a healthy analysis.






#### Data Selection. 

The following datasets were selected for further analysis.

```{r}

dailyActivity <- read_csv("E:/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
View(dailyActivity)

```



```{r}

sleep_Day <- read_csv("E:/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
View(sleep_Day)

```



```{r}

hourly_Calories <- read_csv("E:/Fitabase Data 4.12.16-5.12.16/hourlyCalories_merged.csv")
View(hourly_Calories)

```



```{r}

hourly_Intensities <- read_csv("E:/Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv")
View(hourly_Intensities)

```



```{r}

hourly_Steps <- read_csv("E:/Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv")
View(hourly_Steps)
```






#### Tools Used:

The tools used for this is R Studio.








<b>3. PROCESS </b>

Here, we will process the data by cleaning and ensuring that it is correct, relevant, complete and free of error and outlier by performing:

* Explore and observe data.
* Check for and treat missing or null values.
* Transform data — format data type.
* Perform preliminary statistical analysis.


#### Observe and familiarize with data.
 
```{r}
#dailyActivity

summary(dailyActivity)
head(dailyActivity)
str(dailyActivity)

```


```{r}
#sleep_Day

summary(sleep_Day)
head(sleep_Day)
str(sleep_Day)

```


```{r}
#hourly_Calories

summary(hourly_Calories)
head(hourly_Calories)
str(hourly_Calories)

```


```{r}
#hourly_Intensities

summary(hourly_Intensities)
head(hourly_Intensities)
str(hourly_Intensities)

```


```{r}
#hourly_Steps

summary(hourly_Steps)
head(hourly_Steps)
str(hourly_Steps)

```




### Checking number of unique users in each dataset.

```{r}

n_distinct(dailyActivity$Id)
n_distinct(hourly_Calories$Id)
n_distinct(hourly_Intensities$Id)
n_distinct(hourly_Steps$Id)
n_distinct(sleep_Day$Id)


```


#### Checking for null values

```{r}

sum(is.null(dailyActivity))
sum(is.null(hourly_Calories))
sum(is.null(hourly_Intensities))
sum(is.null(hourly_Steps))
sum(is.null(sleep_Day))

```


Observations as recorded:

* dailyActivity data available for 2016-04-12 and 2016-05-12 with 33 unique IDs.

* hourly_activity data available for 2016-04-12 and 2016-05-12 with with 33 unique IDs.

* Even though 30 respondents were recorded, the dataset consists of 33 entries Some users may have created      additional Ids while filling the survey. Ids.

* No null values were found in the datasets.

* sleep data available for 2016-04-12 and 2016-05-12 with with 24 unique Ids.

* weight_log data available for 2016-04-12 and 2016-05-12 with with 8 unique Ids.

* Only 24% and 73% of users are willing to track weight and sleep time respectively.






Now that we have identified the dirty data, we will then perform data manipulation/transformation.

* Convert the datatype of ActivityDate column from dailyActivity dataset to date type from character type.
* Create a Date column in dailyActivity dataset.

```{r}

dailyActivity$ActivityDate <- as.POSIXct(dailyActivity$ActivityDate, format= "%m/%d/%Y", tz = Sys.timezone())
dailyActivity$Date <- format(dailyActivity$ActivityDate,format = "%m/%d/%y")


head(dailyActivity)

```





* Merge the datasets hourly_Calories, hourly_Intensities, hourly_Steps into one called hourlyActivity

```{r}

hourlyActivity <- Reduce(merge, list(hourly_Calories, hourly_Intensities, hourly_Steps))

sum(is.na(hourlyActivity))
head(hourlyActivity)
str(hourlyActivity)

```





* Convert the datatype of ActivityHour column from hourlyActivity dataset to date type from character type
* Make three other columns for Date, Time and Day in hourlyActivity dataset.

```{r}

hourlyActivity$ActivityHour <- as.POSIXct(hourlyActivity$ActivityHour, format = "%m/%d/%Y %I:%M:%S %p", tz= Sys.timezone())
hourlyActivity$Date <- format(hourlyActivity$ActivityHour, format = "%m/%d/%Y" )
hourlyActivity$Time <- format(hourlyActivity$ActivityHour, format = "%H" )
hourlyActivity$Day <- format(hourlyActivity$ActivityHour, format = "%A")

head(hourlyActivity)
str(hourlyActivity)

```





* Convert the datatype of SleepDay column from sleepDay dataset to timestamp format.
* Make a column for Date.

```{r}

sleep_Day$SleepDay <- as.POSIXct(sleep_Day$SleepDay, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
sleep_Day$Date <- format(sleep_Day$SleepDay,format = "%m/%d/%y")

head(sleep_Day)


```








<b>4. ANALYSE </b>

#### Perform calculations:

Pulling statistics for analysis

* mean (average)
* std (standard deviation)
* min and max
* percentiles 25%, 50%, 75%

#### Aggregating data.

#### Formatting and creating useful data.


```{r}

summary(dailyActivity)

summary(hourlyActivity)

summary(sleep_Day)

```




Daily Activity Record Summary

```{r}

## Daily activity summary on distance covered based on levels. 

dailyActivity %>%
    select(VeryActiveDistance, ModeratelyActiveDistance, LightActiveDistance, SedentaryActiveDistance)%>%
    summary()

```


```{r}
## Daily activity summary on distance covered based on steps.

dailyActivity %>%
    select(TotalSteps, TotalDistance, TrackerDistance)%>%
    summary()

```


```{r}
## Daily activity summary on distance covered based on active minutes.

dailyActivity  %>%
    select(VeryActiveMinutes,FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes)%>%
    summary()

```




Sleep Record Summary

```{r}

sleep_Day %>%
  select(TotalSleepRecords, TotalMinutesAsleep, TotalTimeInBed) %>%
  summary()

```




Hourly Activity Record Summary

```{r}

hourlyActivity %>%
  select(Calories, TotalIntensity, StepTotal) %>%
  summary()


```




#### Findings from summaries:

* Average steps in a day is found to be 7638. However, average of 10,000 steps is commonly recommended to stay fit. So, steps per day need to be maintained.

* 75% users are maintaining 10,000 steps per day according 3rd quartile stat of TotalSteps.

* Average Sedentary/Inactive Minutes per day is 991 minutes i.e., 16.5 hours which is 2/3rd of day. This needs to be reduced.(assuming sleep time may or maynot recorded).

* Total Time in bed is recorded average of 458.6 minutes i.e., 7.6 hours after sleep is quite too long if assumed user is not working on bed.

* Noting that average calories burned is 2,303 calories equivalent to 0.6 pound. Could not interpret into detail as calories burned depend on several factors such as the age, weight, daily tasks, exercise, hormones and daily calorie intake. Source: Health Line article










<b>5. SHARE </b>


#### Creating a custom theme which we'll be using on our visualization further.

```{r}
custom_theme <- function() {
  theme(
    panel.border = element_rect(colour = "black", 
                                fill = NA, 
                                linetype = 1),
    panel.background = element_rect(fill = "white", 
                                    color = 'grey50'),
    #     panel.grid.minor.y = element_blank(),
    axis.text = element_text(size=14,colour = "black", 
                             face = "italic", 
                             family = "Helvetica"),
    axis.title = element_text(size=16,colour = "black", 
                              family = "Helvetica"),
    axis.ticks = element_line(colour = "black"),
    plot.title = element_text(size=23, 
                              hjust = 0.5, 
                              family = "Helvetica"),
    plot.subtitle=element_text(size=18, 
                               hjust = 0.5),
    plot.caption = element_text(size=16,colour = "black", 
                                face = "italic", 
                                family = "Helvetica"),
    legend.text = element_text(size=14,colour = "black"),
    legend.title = element_text(size= 18,colour = "black")
  )
}

```






#### Visualizing Number of Steps in a day

```{r}


options(repr.plot.width = 10, repr.plot.height = 8)
dailyActivity$weekday <- weekdays(as.Date(dailyActivity$Date, format = "%m/%d/%Y"))
dailyActivity$weekday <- factor(dailyActivity$weekday, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday","Sunday"))

dailyActivity_steps_grouped <- dailyActivity %>%
  group_by(weekday) %>%
  drop_na() %>%
  summarise(mean_total_steps = mean(TotalSteps))

head(dailyActivity_steps_grouped)


plot <- ggplot(dailyActivity_steps_grouped, aes(x = weekday, y = mean_total_steps, fill = mean_total_steps ))
plot + geom_col() + labs(y = "Average Steps", 
                         x = "Weekday", 
                         title = "Average steps by week", 
                         caption = paste0("Data of 33 users from date 4/12/2016 to 5/12/2016"),
                         fill = "TotalSteps") + custom_theme()


```


Users tends to be excersing at medium pace on working days and significantly higher than usual on Saturdays. On Sundays, users excersing less and relaxing more.




#### Now we will analyse the average of active levels by weekday

```{R}

dailyActivity_active_minutes <- dailyActivity %>%
  drop_na() %>%  
  group_by(weekday) %>% 
  select(VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes) %>%
  summarise(veryActive_mean = mean(VeryActiveMinutes),
            fairlyActive_mean = mean(FairlyActiveMinutes),
            lightlyActive_mean = mean(LightlyActiveMinutes),
            sedentary_mean = mean(SedentaryMinutes) )

dailyActivity_active_minutes

```

From above table, we can say that users are lightly active for atleast 3 hrs in a day through out the week. Due to office work or any other activity in a day, sedentary minutes are relatively higher in a day. Bellabeat can remind the users to talk a walk for 5-10 mins for every 2-3 hrs from avoiding continuous sitting risks and increase their productivity.





#### Average Active Steps by Weekdays

```{r}

options(repr.plot.width = 8, repr.plot.height = 8)
plot1 <- ggplot(dailyActivity_active_minutes, aes(x= weekday, y = veryActive_mean, group = 1))
plot1 + geom_line(color = "blue") + geom_point() + labs(x = "Weekday",
                                                      y = "Daily Highly Active Minutes",
                                                      title = "Average Active Steps by Weekdays") + custom_theme() 


```





#### Average Fairly Active Steps by Weekdays

```{r}

options(repr.plot.width = 8, repr.plot.height = 8)
plot2 <- ggplot(dailyActivity_active_minutes, aes(x= weekday, y = fairlyActive_mean, group = 1))
plot2 + geom_line(color = "blue") + geom_point() + labs(x = "Weekday",
                                                      y = "Daily Fairly Active Minutes",
                                                      title = "Average Fairly Active Steps by Weekdays") + custom_theme()


```





#### Average Lightly Active Steps by Weekdays

```{r}

options(repr.plot.width = 8, repr.plot.height = 8)
plot3 <- ggplot(dailyActivity_active_minutes, aes(x= weekday, y = lightlyActive_mean, group = 1))
plot3 + geom_line(color = "blue") + geom_point() + labs(x = "Weekday",
                                                      y = "Daily Lightly Active Minutes",
                                                      title = "Average Lightly Active Steps by Weekdays") + custom_theme()


```





#### Average Sedentary Active Steps by Weekdays

```{r}

options(repr.plot.width = 8, repr.plot.height = 8)
plot4 <- ggplot(dailyActivity_active_minutes, aes(x= weekday, y = sedentary_mean, group = 1))
plot4 + geom_line(color = "blue") + geom_point() + labs(x = "Weekday",
                                                      y = "Daily Sedentary Active Minutes",
                                                      title = "Average Sedentary Active Steps by Weekdays") + custom_theme()

```



Reviewing activity levels, we can see the overall trend in user's activity:

* Activity level are high on Monday and Tuesday with a steady decline from Tuesday till Thursday indicating that people tend to perform less physical activities in the middle of the week. 
* After Thursday, we can find a significant rise in the physical activity. This could be because people tend to workout or go for walks and again on sunday it reduces.





#### Visualizing Calories V/S Total Steps

```{r}

options(repr.plot.width = 6, repr.plot.height = 6)
ggplot(data = dailyActivity, aes(x = TotalSteps, y = Calories)) +
     geom_point() + geom_smooth()+ labs(title="Calories vs Total Steps")+custom_theme()

```

Findings:

* It is a positive correlation.
* We observed that intensity of calories burned increase when users are at the range of > 0 to 15,000 steps with calories burn rate cooling down from 15,000 steps onwards.
* Noted a few outliers:
  a. Zero steps with zero to minimal calories burned.
  b. 1 observation of > 35,000 steps with < 3,000 calories burned.
  c. Deduced that outliers could be due to natural variation of data, change in user’s usage or errors in data      collection (ie. miscalculations, data contamination or human error).





#### Visualizing Total Distance V/s Total Steps

```{r}

ggplot(data = dailyActivity, aes(x = TotalSteps, y = TotalDistance)) +
  geom_point()+geom_smooth()+ labs(title="Total Distance vs Total Steps")+custom_theme()

```






### Hourly Activity Analysis

```{r}

head(hourlyActivity)
str(hourlyActivity)

hourlyActivity_modified <- hourlyActivity %>%
  group_by(Day, Time) %>%
  drop_na() %>%
  summarise(Total_intensity_mean = mean(TotalIntensity))

hourlyActivity_modified
 
options(repr.plot.width = 12, repr.plot.height = 6)
ggplot(hourlyActivity_modified) +  geom_col(aes(x = Time, y = Total_intensity_mean)) +
  labs(x = "Time(hour)", 
       y = "Average Intensity", 
       title = "Hourly Intensity By Day", 
       caption = paste0("Data of 33 users from date 4/12/2016 to 5/12/2016")) + custom_theme()


```

Observation recorded indicates that most of the respondents were active during the the evening hourse i.e., between 5-8pm. 





#### Hourly Intensity of a Day Throughout the week

```{r}

ggplot(hourlyActivity_modified) +
  geom_col(aes(x = Time, y = Total_intensity_mean, fill = Total_intensity_mean)) + facet_wrap(~Day) +
  labs(title="Hourly Intensity of a Day",
       caption = paste0("Data of 33 users from date 4/12/2016 to 5/12/2016"), 
       x="Time(hour)",
       y="Average intensity",fill = "Intensity") + custom_theme() +
  theme(axis.text.x = element_text(size = 9))

options(repr.plot.width = 10, repr.plot.height = 10)

```

We find that respondents usually exercise between 6pm and 7pm on weekdays. On Saturdays, they are very active between 1pm to 7pm and saturday records the highest number of active hours in the entire week as most of the respondents are active during the above mentioned hours. On Sunday, the activity level dropped significantly. 





Let's now analyse, On which week day how active the users are.

```{r}

daily_df <- merge(dailyActivity, sleep_Day, by = c('Id', 'Date'), all.x = TRUE)
daily_df <- daily_df %>% drop_na()

head(daily_df)
n_distinct(daily_df$Id)

```





#### Sleep minutes v/s weekday

```{r}

daily_df$weekday <- weekdays(daily_df$ActivityDate)
daily_df$weekday <- factor(daily_df$weekday, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday","Sunday"))
options(repr.plot.width = 8, repr.plot.height = 8)
daily_df_group_sleep <- daily_df %>%
  group_by(weekday) %>%
  drop_na() %>%
  summarise(mean_TotalMinutesAsleep = mean(TotalMinutesAsleep))



ggplot(data = daily_df_group_sleep)+ geom_col(mapping = aes( x = weekday, y = mean_TotalMinutesAsleep, fill = mean_TotalMinutesAsleep))+
  labs(title = "Average Sleep each day of the week ", 
       caption = paste0("Data of 24 users from date 4/12/2016 to 5/12/2016"), 
       x="Week day", y = "Average Sleep Minutes", 
       fill = "Total Sleep Minutes")+custom_theme()


```


From the graph, we find that, people sleep more on weekends. Average of 400 mins i.e 6-7 hrs is maintained in working days. As per common recommendations, between 7-9 hrs of sleep is must.





#### Total time in bed V/s Total Minutes Asleep

```{r}

options(repr.plot.width = 8, repr.plot.height = 8)
#Total Time in bed & Sleep time correlation
ggplot(daily_df, aes(x=TotalMinutesAsleep, y=TotalTimeInBed)) + 
  geom_point()+geom_smooth()+ labs(title="Total Time in Bed Vs Total Minutes Asleep ")+custom_theme()

```


The relationship between Total Minutes Asleep and Total Time in Bed seems to be linear. So, if the Bellabeat app users want to improve their sleeping hour, we should consider giving a notification via app to sleep at a specific time, set by the user.

Based on this visual we can infer that there is some correlation between time asleep and time spent in bed. 

Hence, Bellabeat should set a reminder to encourage people to spend less time on bed. Though, there are some ouliers, showing that some of the people face struggle to sleep, even after spending long duration on bed.

Here, TotalTimeInBed includes sleep time. Let's analyse extra time in bed and sleep time to know how correlated they are.







#### Extra Time In Bed V/s Total Minutes Asleep

```{r}

daily_df$ExtraTimeInbed <- daily_df$TotalTimeInBed- daily_df$TotalMinutesAsleep

ggplot(data=daily_df, aes(x=TotalMinutesAsleep, y=ExtraTimeInbed)) + 
  geom_point(color='darkblue')+geom_smooth()+ labs(title="Extra Time in Bed Vs Total Minutes Asleep")+custom_theme()


```

The above plot shows that majority of users spend atleast 30-60 mins in bed after or before sleep time. However, we can observe that some users spending time in bed more than half of sleep time, the reasons could be users might be working on bed, just scrolling phone, or having insomnia. Bellabeat should put up active reminders to ensure the user to stay productive and healthy.






Lastly, we will have a look at the relationship between Total Minutes Asleep and Sedentary Minutes.

```{r}

ggplot(data=daily_df, aes(x=TotalMinutesAsleep, y=SedentaryMinutes)) + 
  geom_point(color='darkblue') + geom_smooth() +
  labs(title="Minutes Asleep vs. Sedentary Minutes")+custom_theme()

```


We can find a negative correlation between Sedentary Minutes and Sleep time. 

So, If a user wishes to improve his/her sleep, the app can recommend reducing the sedentary time. 

Though, correlation doesn't always implies causation, we need to support this insight with more data.







<b>6. ACT </b>

In the final step, we will be delivering our insights and providing recommendations based on our analysis.

Here, we revisit our business questions and share with you our high-level business recommendations.


1. What are the trends identified?

* Majority of users are using the FitBit app to track sedentary activities and not using it for tracking their health habits.

* Users prefer to track their activities during weekdays as compared to weekends -  perhaps because they spend more time outside on weekdays and stay in on weekends.


2. How could these trends apply to Bellabeat customers?

* Both companies develop products focused on providing women with their health, habit and fitness data and encouraging them to understand their current habits and make healthy decisions. These common trends surrounding health and fitness can very well be applied to Bellabeat customers.


3. How could these trends help influence Bellabeat marketing strategy?


* Bellabeat marketing team can encourage users by educating and equipping them with knowledge about fitness benefits, suggest different types of exercise (ie. simple 10 minutes exercise on weekday and a more intense exercise on weekends) and calories intake and burnt rate information on the Bellabeat app.

* On weekends, Bellabeat app can also prompt notification to encourage users to exercise.

* Can notify the user to drink water every hour by setting reminders, helping them stay hydrated. Besides tracking only activities like steps, sleep time, weight and heartrates; Bellabeat can offer sessions on eating habits, yoga etc., more often.

* We observed a clear relation between higher intensity activity and calories burned so logging the activity with the an interative app/device could be a good motivator to increase your activity if any user has some kind of plan to lose weight.
  
